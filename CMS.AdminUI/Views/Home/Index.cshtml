@{
    ViewBag.Title = "星联科技CMS后台";

    Layout = null;
}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>星联科技管理后台</title>
    <meta http-equiv="x-ua-compatible" content="ie=7" />
    <link href="@Url.Content("~/Content/login/screen.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/login/base.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/login/login.css")" rel="stylesheet" type="text/css" />
    <script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
    @*<style type="text/css">
        .top{ width:100%; height:242px; background:url(/content/img/top.png) no-repeat;}
        .body{ width:100%;}
        .left{ float:left; width:609px; margin-left:-1px; height:371px; background:url(/content/img/left.png) no-repeat;}
        .right{ float:right; width:481px; height:371px; line-height:30px; color:#197ba2; background:url(/content/img/right.png) no-repeat;}
        .right .input{ border:solid 1px #197ba2; width:158px; height:22px;line-height:22px;text-indent:0.5em; margin:2px 0px;}
    </style>*@
</head>
    <body>
        <div class="logina-logo" style="font-size: 30px">
            星联科技网站管理后台
        </div>
        <div class="logina-main main clearfix">
            <div class="tab-con">
                    <table border="0" cellspacing="0" cellpadding="0">
                        <tbody>
                            <tr>
                                <th>用户名:</th>
                                <td width="245">
                                    <input class="input" id="txtUserName" name="UserName" type="text" />
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <th>密&nbsp;&nbsp;&nbsp;码:</th>
                                <td width="245">
                                    <input class="input" id="txtPassword" name="Password" type="password" />
                                </td>
                                <td></td>
                            </tr>
                            <tr id="tr-vcode">
                                <th>验证码:</th>
                                <td width="245">
                                    <div class="valid">
                                        <input class="input" id="txtVerifyCode" name="VerifyCode" type="text"/>&nbsp; 
                                        <img src="/VerifyCode/VerifyCode/" width="70" height="30" id="imgVerifyCode" style="cursor:pointer;" alt="验证码,不区分大小写" />
                                    </div>
                                </td>
                                <td></td>
                            </tr>
                            <tr>
                                <th></th>
                                <td width="245"><input class="confirm" type="button" id="imgLogin" value="登  录" /></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
            </div>
           
        </div>
        <div id="footer">
            <div class="copyright"> 星联科技  版权所有</div>
        </div>
        @*<div class="all">
        <div class="main">
            <div class="top">
            </div>
            <div class="body">
                <div class="left">
                </div>
                <div class="right">
                    <span>用户名：</span><input class="input" id="txtUserName" name="UserName" type="text" /><br />
                    <span>密&nbsp;&nbsp;&nbsp;码：</span><input class="input" id="txtPassword" name="Password" type="password" /><br />
                    <span>验证码：</span><input class="input" id="txtVerifyCode" name="VerifyCode" type="text" style="width:72px;" />&nbsp; <img src="/VerifyCode/VerifyCode/" width="68" height="20" id="imgVerifyCode" style="cursor:pointer;" alt="验证码,不区分大小写"/><br />
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    <input type="image" src="@Url.Content("~/content/img/join.png")" id="imgLogin" />&nbsp; 
                    <input type="image" src="@Url.Content("~/content/img/cz.png")" id="imgReset"/>&nbsp;
                </div>
                <p class="clear" />
            </div>
        </div>
    </div>*@
        <script src="/Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function () {
                $("#imgVerifyCode").bind("click", function () {
                    this.src = "/VerifyCode/VerifyCode/?rnd=" + Math.random();
                });

                $("#txtUserName,#txtPassword,#txtVerifyCode").keydown(function (event) {
                    if (event.keyCode == 13) {
                        login();
                    }
                });

                // login
                $("#imgLogin").click(function () {
                    login();
                });

                // reset
                $("#imgReset").click(function () {
                    Reset();
                })
            });

            function login() {
                var username = $.trim($('#txtUserName').val());
                var password = $.trim($('#txtPassword').val());
                var verifycode = $.trim($('#txtVerifyCode').val());
                if (username.length == 0) {
                    alert('请输入用户名');
                    $('#txtUserName').focus();
                    return false;
                }
                else if (password.length == 0) {
                    alert('请输入密码');
                    $('#txtPassword').focus();
                    return false;
                }
                else if (verifycode.length == 0) {
                    $('#txtVerifyCode').focus();
                    alert('请输入验证码');
                    return false;
                }

                $.ajax({
                    type: 'POST',
                    url: '/login/',
                    data: { UserName: $('#txtUserName').val(), Password: $('#txtPassword').val(), VerifyCode: $('#txtVerifyCode').val() },
                    cache: false,
                    success: function (data) {
                        var e = eval("(" + data + ")");
                        if (e.result == 'success') {
                            location.href = e.url;
                        }
                        else if (e.result == 'failure') {
                            $("#imgVerifyCode").click();
                            alert(e.msg);
                        }
                        else if (e.result == 'error') {
                            $("#imgVerifyCode").click();
                            alert(e.msg);
                        }
                    },
                    error: function (xhr) {
                        throw new Error('数据源访问错误' + '\n' + xhr.responseText);
                    }
                });
            }

            function Reset() {
                $('#txtUserName').val('');
                $('#txtPassword').val('');
                $('#txtVerifyCode').val('');
            }
        </script>
    </body>
</html>
